<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vinayaka Industries | Excavator Spare Parts Catalog</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .modal-overlay {
            background-color: rgba(0,0,0,0.7);
        }
        .loading-spinner {
            border-top-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .spec-table tr:nth-child(even) {
            background-color: #f8fafc;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-blue-900 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <img src="https://via.placeholder.com/80" alt="Vinayaka Industries Logo" class="h-16 w-16 mr-4 rounded-full border-2 border-white">
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold">VINAYAKA INDUSTRIES</h1>
                        <p class="text-blue-200">Specialists in Excavator Swing & Travel Device Spare Parts</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input type="text" placeholder="Search parts..." class="px-4 py-2 rounded-full text-gray-800 w-64 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button class="absolute right-3 top-2 text-gray-500">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <button class="bg-blue-700 hover:bg-blue-600 px-4 py-2 rounded-lg flex items-center">
                        <i class="fas fa-user mr-2"></i>
                        <span>Login</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Filters Section -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">Filter Parts</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">MODEL</label>
                    <select id="model-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Models</option>
                        <!-- Models will be populated dynamically -->
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">DEVICE</label>
                    <select id="device-filter" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Devices</option>
                        <!-- Devices will be populated dynamically -->
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ITEM NAME</label>
                    <input type="text" id="item-name-filter" placeholder="Search item name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div class="flex items-end">
                    <button id="reset-filters" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-md mr-2">
                        Reset
                    </button>
                    <button id="apply-filters" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md">
                        Apply Filters
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="mb-8 flex justify-between items-center">
            <h2 class="text-2xl font-semibold text-gray-800">Available Spare Parts</h2>
            <div class="flex items-center">
                <span class="text-sm text-gray-600 mr-2">Sort by:</span>
                <select id="sort-by" class="px-3 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    <option value="name-asc">Name (A-Z)</option>
                    <option value="name-desc">Name (Z-A)</option>
                    <option value="price-asc">Price (Low-High)</option>
                    <option value="price-desc">Price (High-Low)</option>
                </select>
            </div>
        </div>

        <!-- Loading State -->
        <div id="loading-state" class="flex justify-center items-center py-20">
            <div class="loading-spinner h-12 w-12 border-4 border-gray-300 rounded-full"></div>
        </div>

        <!-- Products Grid -->
        <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 hidden">
            <!-- Product cards will be inserted here by JavaScript -->
        </div>

        <!-- No Results Message -->
        <div id="no-results" class="hidden text-center py-12">
            <i class="fas fa-box-open text-5xl text-gray-300 mb-4"></i>
            <h3 class="text-xl font-medium text-gray-600">No parts found matching your criteria</h3>
            <p class="text-gray-500 mt-2">Try adjusting your filters or search terms</p>
        </div>

        <!-- Pagination -->
        <div id="pagination" class="flex justify-center mt-8 hidden">
            <nav class="inline-flex rounded-md shadow">
                <button class="px-3 py-1 rounded-l-md border border-gray-300 bg-white text-gray-500 hover:bg-gray-50">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="px-3 py-1 border-t border-b border-gray-300 bg-blue-50 text-blue-600 font-medium">1</button>
                <button class="px-3 py-1 border border-gray-300 bg-white text-gray-500 hover:bg-gray-50">2</button>
                <button class="px-3 py-1 border border-gray-300 bg-white text-gray-500 hover:bg-gray-50">3</button>
                <button class="px-3 py-1 rounded-r-md border border-gray-300 bg-white text-gray-500 hover:bg-gray-50">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </nav>
        </div>
    </main>

    <!-- Product Detail Modal -->
    <div id="product-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="relative min-h-screen flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white p-4 border-b flex justify-between items-center">
                    <h3 class="text-xl font-semibold text-gray-800">Product Details</h3>
                    <button id="close-modal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                
                <div class="p-6">
                    <div class="flex flex-col md:flex-row gap-8">
                        <div class="w-full md:w-1/3">
                            <div class="bg-gray-100 rounded-lg overflow-hidden mb-4">
                                <img id="modal-product-image" src="https://via.placeholder.com/400x300" alt="Product Image" class="w-full h-auto">
                            </div>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="bg-gray-200 rounded cursor-pointer">
                                    <img src="https://via.placeholder.com/100" alt="Thumbnail" class="w-full h-auto">
                                </div>
                                <div class="bg-gray-200 rounded cursor-pointer">
                                    <img src="https://via.placeholder.com/100" alt="Thumbnail" class="w-full h-auto">
                                </div>
                                <div class="bg-gray-200 rounded cursor-pointer">
                                    <img src="https://via.placeholder.com/100" alt="Thumbnail" class="w-full h-auto">
                                </div>
                            </div>
                        </div>
                        
                        <div class="w-full md:w-2/3">
                            <h2 id="modal-product-name" class="text-2xl font-bold text-gray-800 mb-2">Swing Bearing for PC200-8</h2>
                            <div class="flex items-center mb-4">
                                <span class="bg-green-100 text-green-800 text-xs font-semibold px-2.5 py-0.5 rounded mr-3">In Stock</span>
                                <span id="modal-product-code" class="text-gray-600 text-sm">Part #: SB-PC200-8-001</span>
                            </div>
                            
                            <div class="mb-6">
                                <span id="modal-product-price" class="text-3xl font-bold text-blue-600">₹12,500</span>
                                <span class="text-gray-500 ml-2">+ GST</span>
                            </div>
                            
                            <div class="mb-6">
                                <h4 class="font-semibold text-gray-800 mb-2">Compatible Models:</h4>
                                <div id="modal-compatible-models" class="flex flex-wrap gap-2">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">PC200-8</span>
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded">PC210-8</span>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-4 mb-8">
                                <div class="flex items-center border border-gray-300 rounded">
                                    <button class="px-3 py-1 text-gray-600 hover:bg-gray-100">-</button>
                                    <input type="text" value="1" class="w-12 text-center border-x border-gray-300 py-1">
                                    <button class="px-3 py-1 text-gray-600 hover:bg-gray-100">+</button>
                                </div>
                                <button class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg flex items-center">
                                    <i class="fas fa-cart-plus mr-2"></i>
                                    Add to Cart
                                </button>
                                <button class="text-blue-600 hover:text-blue-800 flex items-center">
                                    <i class="far fa-heart mr-1"></i>
                                    <span>Save</span>
                                </button>
                            </div>
                            
                            <div class="mb-6">
                                <h4 class="font-semibold text-gray-800 mb-2">Description:</h4>
                                <p id="modal-product-description" class="text-gray-600">High-quality swing bearing designed specifically for Komatsu PC200-8 excavators. Manufactured with premium materials for extended durability and performance under heavy load conditions.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-4">Technical Specifications</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full spec-table">
                                <tbody id="modal-product-specs">
                                    <!-- Specifications will be inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-lg font-semibold mb-4">VINAYAKA INDUSTRIES</h3>
                    <p class="text-gray-400">Specialists in excavator swing and travel device spare parts manufacturing since 1995.</p>
                    <div class="mt-4 flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Home</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Products</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Product Categories</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Swing Devices</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Travel Devices</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Swing Bearings</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Travel Motors</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Contact Us</h3>
                    <address class="not-italic text-gray-400">
                        <p><i class="fas fa-map-marker-alt mr-2"></i> 123 Industrial Area, Bangalore, Karnataka 560058</p>
                        <p class="mt-2"><i class="fas fa-phone mr-2"></i> +91 80 1234 5678</p>
                        <p class="mt-2"><i class="fas fa-envelope mr-2"></i> info@vinayakaindustries.com</p>
                    </address>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2023 Vinayaka Industries. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Google Sheets CSV URL
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRFxJyIv-_4zkNDXwmv5dYgWE-LRybVLKayk8jmiUCdbuL1XX4Ac0DuU5ip1jZmo-GaDQwWUhJFw8Pt/pub?output=csv';
            {
                id: 2,
                name: "Travel Motor",
                model: "PC210",
                modelNumber: "PC210LC-8",
                componentType: "Travel Device",
                partNumber: "TM-PC210LC-8-002",
                description: "Replacement travel motor for Komatsu PC210LC-8 excavators",
                price: 28500,
                stock: "In Stock",
                image: "https://via.placeholder.com/400x300?text=Travel+Motor",
                specs: [
                    { name: "Type", value: "Hydraulic" },
                    { name: "Displacement", value: "56 cm³/rev" },
                    { name: "Max Pressure", value: "350 bar" },
                    { name: "Rotation Speed", value: "3000 rpm" },
                    { name: "Weight", value: "32 kg" }
                ]
            },
            {
                id: 3,
                name: "Swing Gearbox",
                model: "PC300",
                modelNumber: "PC300-7",
                componentType: "Swing Device",
                partNumber: "SG-PC300-7-003",
                description: "Heavy-duty swing gearbox for Komatsu PC300-7 excavators",
                price: 18700,
                stock: "Low Stock",
                image: "https://via.placeholder.com/400x300?text=Swing+Gearbox",
                specs: [
                    { name: "Gear Ratio", value: "180:1" },
                    { name: "Input Speed", value: "2000 rpm" },
                    { name: "Output Torque", value: "25,000 Nm" },
                    { name: "Weight", value: "68 kg" },
                    { name: "Oil Capacity", value: "3.5 liters" }
                ]
            },
            {
                id: 4,
                name: "Travel Reduction Gear",
                model: "PC400",
                modelNumber: "PC400-6",
                componentType: "Travel Device",
                partNumber: "TRG-PC400-6-004",
                description: "Travel reduction gear assembly for Komatsu PC400-6 excavators",
                price: 22400,
                stock: "In Stock",
                image: "https://via.placeholder.com/400x300?text=Travel+Gear",
                specs: [
                    { name: "Gear Ratio", value: "50:1" },
                    { name: "Max Input Speed", value: "2500 rpm" },
                    { name: "Output Torque", value: "18,000 Nm" },
                    { name: "Weight", value: "42 kg" },
                    { name: "Oil Type", value: "SAE 90" }
                ]
            },
            {
                id: 5,
                name: "Swing Ring Gear",
                model: "PC200",
                modelNumber: "PC200-8",
                componentType: "Swing Device",
                partNumber: "SRG-PC200-8-005",
                description: "Replacement swing ring gear for Komatsu PC200-8 excavators",
                price: 9800,
                stock: "In Stock",
                image: "https://via.placeholder.com/400x300?text=Swing+Ring+Gear",
                specs: [
                    { name: "Material", value: "Case-hardened steel" },
                    { name: "Diameter", value: "920 mm" },
                    { name: "Tooth Count", value: "128" },
                    { name: "Module", value: "6" },
                    { name: "Weight", value: "28 kg" }
                ]
            },
            {
                id: 6,
                name: "Travel Sprocket",
                model: "PC210",
                modelNumber: "PC210LC-8",
                componentType: "Travel Device",
                partNumber: "TS-PC210LC-8-006",
                description: "Durable travel sprocket for Komatsu PC210LC-8 excavators",
                price: 15300,
                stock: "Out of Stock",
                image: "https://via.placeholder.com/400x300?text=Travel+Sprocket",
                specs: [
                    { name: "Material", value: "Forged steel" },
                    { name: "Tooth Count", value: "11" },
                    { name: "Pitch", value: "216 mm" },
                    { name: "Bore Diameter", value: "120 mm" },
                    { name: "Weight", value: "38 kg" }
                ]
            },
            {
                id: 7,
                name: "Swing Motor",
                model: "PC300",
                modelNumber: "PC300-7",
                componentType: "Swing Device",
                partNumber: "SM-PC300-7-007",
                description: "High-performance swing motor for Komatsu PC300-7 excavators",
                price: 24500,
                stock: "In Stock",
                image: "https://via.placeholder.com/400x300?text=Swing+Motor",
                specs: [
                    { name: "Type", value: "Axial piston" },
                    { name: "Displacement", value: "45 cm³/rev" },
                    { name: "Max Pressure", value: "320 bar" },
                    { name: "Rotation Speed", value: "2800 rpm" },
                    { name: "Weight", value: "26 kg" }
                ]
            },
            {
                id: 8,
                name: "Travel Brake Assembly",
                model: "PC400",
                modelNumber: "PC400-6",
                componentType: "Travel Device",
                partNumber: "TB-PC400-6-008",
                description: "Complete travel brake assembly for Komatsu PC400-6 excavators",
                price: 13200,
                stock: "In Stock",
                image: "https://via.placeholder.com/400x300?text=Travel+Brake",
                specs: [
                    { name: "Type", value: "Multi-disc wet brake" },
                    { name: "Disc Count", value: "8" },
                    { name: "Actuation", value: "Hydraulic" },
                    { name: "Max Torque", value: "15,000 Nm" },
                    { name: "Weight", value: "22 kg" }
                ]
            }
        ];

        // DOM Elements
        const productsGrid = document.getElementById('products-grid');
        const loadingState = document.getElementById('loading-state');
        const noResults = document.getElementById('no-results');
        const pagination = document.getElementById('pagination');
        const productModal = document.getElementById('product-modal');
        const closeModal = document.getElementById('close-modal');
        
        // Filter elements
        const modelFilter = document.getElementById('model-filter');
        const componentFilter = document.getElementById('component-filter');
        const partNumberFilter = document.getElementById('part-number-filter');
        const applyFiltersBtn = document.getElementById('apply-filters');
        const resetFiltersBtn = document.getElementById('reset-filters');
        const sortBy = document.getElementById('sort-by');

        // Current products array (will be populated from Google Sheets)
        let currentProducts = [];
        let uniqueModels = new Set();
        let uniqueDevices = new Set();

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Fetch products from Google Sheets
            fetchProductsFromSheet().then(products => {
                currentProducts = products;
                
                // Get unique models and devices
                products.forEach(product => {
                    if (product.MODEL) uniqueModels.add(product.MODEL);
                    if (product.DEVICE) uniqueDevices.add(product.DEVICE);
                });
                
                // Populate model filter dropdown
                const modelFilter = document.getElementById('model-filter');
                uniqueModels.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model;
                    option.textContent = model;
                    modelFilter.appendChild(option);
                });
                
                // Populate device filter dropdown
                const deviceFilter = document.getElementById('device-filter');
                uniqueDevices.forEach(device => {
                    const option = document.createElement('option');
                    option.value = device;
                    option.textContent = device;
                    deviceFilter.appendChild(option);
                });
                
                displayProducts(currentProducts);
                loadingState.classList.add('hidden');
                productsGrid.classList.remove('hidden');
                pagination.classList.remove('hidden');
            }).catch(error => {
                console.error('Error loading products:', error);
                loadingState.classList.add('hidden');
                noResults.classList.remove('hidden');
            });
            
            // Set up event listeners
            setupEventListeners();
        });

        function setupEventListeners() {
            // Filter buttons
            applyFiltersBtn.addEventListener('click', applyFilters);
            resetFiltersBtn.addEventListener('click', resetFilters);
            
            // Sorting
            sortBy.addEventListener('change', applySorting);
            
            // Modal
            closeModal.addEventListener('click', () => {
                productModal.classList.add('hidden');
            });
            
            // Click outside modal to close
            productModal.addEventListener('click', (e) => {
                if (e.target === productModal) {
                    productModal.classList.add('hidden');
                }
            });
        }

        function displayProducts(products) {
            productsGrid.innerHTML = '';
            
            if (products.length === 0) {
                noResults.classList.remove('hidden');
                productsGrid.classList.add('hidden');
                pagination.classList.add('hidden');
                return;
            }
            
            noResults.classList.add('hidden');
            productsGrid.classList.remove('hidden');
            pagination.classList.remove('hidden');
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white rounded-lg shadow-md overflow-hidden product-card transition duration-300';
                productCard.innerHTML = `
                    <div class="relative h-48 bg-gray-100 overflow-hidden">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover">
                        <div class="absolute bottom-2 left-2 bg-blue-600 text-white text-xs font-bold px-2 py-1 rounded">
                            ${product.stock}
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="text-lg font-semibold text-gray-800 mb-1">${product['ITEM NAME']}</h3>
                        <div class="flex items-center text-sm text-gray-600 mb-2">
                            <span class="mr-2">${product.MODEL} ${product['MODEL NUMBER']}</span>
                            <span class="bg-gray-100 px-2 py-0.5 rounded">${product.DEVICE}</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-3 line-clamp-2">${product.SIZE || ''}</p>
                        <div class="flex justify-between items-center">
                            <span class="text-blue-600 font-bold">₹${product.price.toLocaleString()}</span>
                            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium view-details" data-id="${product.id}">
                                View Details <i class="fas fa-chevron-right ml-1"></i>
                            </button>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
            
            // Add event listeners to view details buttons
            document.querySelectorAll('.view-details').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-id'));
                    showProductDetails(productId);
                });
            });
        }

        function showProductDetails(productId) {
            const product = currentProducts.find(p => p.id === productId);
            if (!product) return;
            
            // Update modal content
            document.getElementById('modal-product-name').textContent = product.name;
            document.getElementById('modal-product-code').textContent = `Part #: ${product.partNumber}`;
            document.getElementById('modal-product-price').textContent = `₹${product.price.toLocaleString()}`;
            document.getElementById('modal-product-description').textContent = product.description;
            document.getElementById('modal-product-image').src = product.image;
            
            // Update compatible models
            const compatibleModels = document.getElementById('modal-compatible-models');
            compatibleModels.innerHTML = '';
            const models = [product.modelNumber];
            if (product.model === 'PC200') models.push('PC210-8');
            if (product.model === 'PC210') models.push('PC200-8');
            
            models.forEach(model => {
                const span = document.createElement('span');
                span.className = 'bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded';
                span.textContent = model;
                compatibleModels.appendChild(span);
            });
            
            // Update specifications
            const specsTable = document.getElementById('modal-product-specs');
            specsTable.innerHTML = '';
            product.specs.forEach(spec => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200';
                row.innerHTML = `
                    <td class="px-4 py-3 font-medium text-gray-700">${spec.name}</td>
                    <td class="px-4 py-3 text-gray-600">${spec.value}</td>
                `;
                specsTable.appendChild(row);
            });
            
            // Show modal
            productModal.classList.remove('hidden');
        }

        function applyFilters() {
            const modelValue = modelFilter.value;
            const deviceValue = deviceFilter.value;
            const itemNameValue = itemNameFilter.value.trim().toLowerCase();
            
            let filteredProducts = [...currentProducts];
            
            if (modelValue) {
                filteredProducts = filteredProducts.filter(product => product.MODEL === modelValue);
            }
            
            if (deviceValue) {
                filteredProducts = filteredProducts.filter(product => product.DEVICE === deviceValue);
            }
            
            if (itemNameValue) {
                filteredProducts = filteredProducts.filter(product => 
                    product['ITEM NAME'] && product['ITEM NAME'].toLowerCase().includes(itemNameValue)
                );
            }
            
            displayProducts(filteredProducts);
        }

        function resetFilters() {
            modelFilter.value = '';
            deviceFilter.value = '';
            itemNameFilter.value = '';
            displayProducts([...currentProducts]);
        }

        function applySorting() {
            const sortValue = sortBy.value;
            let sortedProducts = [...currentProducts];
            
            switch(sortValue) {
                case 'name-asc':
                    sortedProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'name-desc':
                    sortedProducts.sort((a, b) => b.name.localeCompare(a.name));
                    break;
                case 'price-asc':
                    sortedProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price-desc':
                    sortedProducts.sort((a, b) => b.price - a.price);
                    break;
                default:
                    break;
            }
            
            displayProducts(sortedProducts);
        }

        async function fetchProductsFromSheet() {
            try {
                const response = await fetch(SHEET_URL);
                const csvData = await response.text();
                
                // Parse CSV to JSON
                const lines = csvData.split('\n');
                const headers = lines[0].split(',');
                
                return lines.slice(1).map(line => {
                    const values = line.split(',');
                    return headers.reduce((obj, header, index) => {
                        obj[header.trim()] = values[index] ? values[index].trim() : '';
                        return obj;
                    }, {});
                });
            } catch (error) {
                console.error('Error fetching products:', error);
                return [];
            }
        }
    </script>
</body>
</html>
